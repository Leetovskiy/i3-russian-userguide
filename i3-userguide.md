# i3 Руководство пользователя

Эта документация содержит всю информацию, которая пригодится для использования и конфигурации оконного менеджера i3. Если по прочтении у Вас остались вопросы, пожалуйста, загляните сначала на https://www.reddit.com/r/i3wm/, затем свяжитесь с нами по IRC (предпочтительно) или опубликуйте свой вопрос в списке почтовой рассылки.

## 1. Стандартные сочетания клавиш

Специально для людей, которые не любят много читать есть небольшая шпаргалка со стандартными сочетаниями клавиш.

**Сочетания с использованием клавиши $mod (Alt или Super):**

![Сочетания с использованием клавиши $mod (Alt или Super)](https://i3wm.org/docs/keyboard-layer1.png)

**Сочетания с использованием клавиш Shift+$mod:**

![Сочетания с использованием клавиш Shift+$mod](https://i3wm.org/docs/keyboard-layer2.png)

Красные клавиши это модификаторы, которые нужно зажать, голубые – домашний ряд.

Обратите внимание, если запуск i3 сопровождается отсутствием конфигурационного файла, i3-config-wizard предложит создать его. Позиции клавиш в этом случае будут совпадать с теми, что изображены на шпаргалке, независимо от раскладки клавиатуры. Если Вы хотите использовать файл конфигурации, где буквенные клавиши совпадают с тем, что вы видите выше, просто отклоните предложение i3-config-wizard и основывайте свою конфигурацию на файле **/etc/i3/config** (прим. переводчика: имеется ввиду, что во втором случае Вы хотите использовать именно буквенные сочетания вместо позиций клавиш).

## 2. Использование i3

В этом руководстве ключевое слово **$mod** ссылается на сконфигурированный модификатор клавиш. По умолчанию это клавиша Alt (**Mod 1**) или Windows (**Mod 4**), которая является популярной альтернативой, предотвращающей конфликты между сочетаниями клавиш, используемыми приложениями.

### 2.1. Запуск терминала и переключение между окнами

Одна из самых базовых операций это запуск терминала. По умолчанию для этого используется сочетание клавиш **$mod+Enter** или Alt+Enter (**Mod1+Enter**) в стандартной конфигурации. По нажатию **$mod+Enter** откроется новый терминал. Он займет все доступное пространство на экране.

![Окно терминала](https://i3wm.org/docs/single_terminal.png)

Теперь, если открыть еще один терминал, i3 поместит его после существующего, разделив экран пополам. В зависимости от Вашего монитора, созданное окно появится рядом с существующим окном (на широких экранах) или под ним.

<img src="https://i3wm.org/docs/two_terminals.png" alt="Два терминала рядом"  />

Чтобы переместить фокус между двумя терминалами можно использовать клавиши направления идентичные редактору **Vi**. Однако, в i3 используется домашний ряд, а в **Vi** эти клавиши смещены влево на одну для совместимости с большинством клавиатурных раскладок. Следовательно, **$mod+j** – направление влево, **$mod+k** – направление вниз, **$mod+l** – вверх, **$mod+;** – вправо. То есть, чтобы переключиться меджу терминалами нужно использовать **$mod+k** или **$mod+l**. И, конечно же, Вы можете использовать клавиши стрелок. 
Сейчас рабочая область разделена (она содержит два окна терминала) в определенном направлении (горизонтальное по умолчанию). Каждое окно можно разделить еще раз по горизонтали или вертикали прямо как рабочую область, которую мы до этого разделили. Термин "окно" используется для контейнера, который на самом деле содержит окно X11 такие, как терминал или браузер, а "split-контейнер" (разделенный контейнер, далее – сплит-контейнер) для контейнеров, которые состоят из одного или нескольких окон.
Чтобы разделить окно по вертикали нажмите **$mod+v**, прежде чем создать новое окно.

### 2.2. Изменение раскладки контейнера

Сплит-контейнер может иметь одну из следующих раскладок:

|                        splith/splitv                         |                           stacking                           |                            tabbed                            |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
| Окна масштабируются по принципу, чтобы каждое из них забирало равное пространство контейнера. ***splith*** распределяет окна по горизонтали (они находятся рядом друг с другом), а ***splitv*** распределяет их по вертикали (окна находятся друг над другом). | В контейнере отображается только то окно, которое в фокусе. Также, сверху контейнера появляется список окон. | Аналогичен ***stacking***, только список окон отображается горизонтально, как вкладки в браузере. |

Чтобы переключаться между режимами раскладки используйте **$mod+e** для ***splith/splitv*** (переключаются между друг другом), **$mod+s** для ***stacking*** и **$mod+w** для ***tabbed***.

![Режимы раскладки контейнера](https://i3wm.org/docs/modes.png)

### 2.3. Переключение полноэкранного режима окна

Для того, чтобы включить или выключить полноэкранный режим окна используйте **$mod+f**.

Также, в i3, существует глобальный полноэкранный режим, который охватывает все доступные выводы. Переключается командой `fullscreen toggle global`.

### 2.4. Запуск других приложений

Вместо того, чтобы запускать приложения из терминала можно использовать удобный лаунчер ***dmenu***, который по умолчанию открывается сочетанием клавиш **$mod+d**. Просто наберите имя приложения (или его часть), которое хотите запустить. Для работы требуется, чтобы приложение находилось в переменной **$PATH**.

Также, для приложений, которые Вы запускаете часто, можно напрямую задать сочетания клавиш. Подробнее в главе Настройка. [TODO:  добавить ссылку на главу]

### 2.5. Закрытие окон

Если приложение не предусматривает механизм завершения (большинство из них предусматривает меню, клавишу escape или горячие клавиши типа **Control-w** для закрытия), можно использовать **$mod+Shift+q**, чтобы "убить" окно. Для приложений, которые поддерживают протокол WM_DELETE, это действие правильно закроет окно (сохранит любые изменения и т. п.). Если же приложение не поддерживает WM_DELETE, то X-сервер просто "убьет" окно, а поведение будет зависеть от определенного приложения.

### 2.6. Использование рабочих пространств

Рабочие пространства (workspaces) это простой способ сгруппировать набор окон. По умолчанию Вы находитесь на первом рабочем пространстве, об этом сообщает индикатор на панели, что находится внизу слева. Чтобы переключиться на другое рабочее пространство нажмите **$mod+num**, где **num** это номер рабочего пространства, которое Вы хотите использовать. Если его не существует, оно будет создано.

Простое применение для этого – переместить браузер на одно рабочее пространство, приложения для общения в сети в другое, а те, с которыми Вы работаете, в третье. Конечно же, Вы не обязаны использовать этот подход.

Если у Вас несколько мониторов, рабочее пространство будет создано для каждого из них во время запуска. Если создать новое рабочее пространство, оно будет привязано к тому экрану, на котором было создано. При переключении к рабочему пространству из другого монитора i3 установит фокус на этот экран.

### 2.7. Перемещение окон между рабочими пространствами

Чтобы переместить окно в другое рабочего пространство просто нажмите **$mod+Shift+num**, где **num** это номер нужного пространства. Также как при переключении, нужное пространство будет создано, если его еще не существует.

### 2.8. Изменение размера

Самый простой способ изменить размер контейнера это использовать мышь: зажмите мышь на границе окна и тяните ее до нужного размера.

Также можно использовать режим привязки клавиш [TODO: добавить ссылку на главу], чтобы менять размеры окна используя клавиатуру. Для примера гляньте на [стандартный конфигурационный файл](https://github.com/i3/i3/blob/next/etc/config.keycodes) предоставленный i3.



### 2.9. Перезапуск i3

Чтобы перезапустить i3 нажмите **$mod+Shift+r**. Пригодится, если произошла какая-то ошибка или нужно обновиться до новой версии оконного менеджера.

### 2.10. Выход из i3

Чтобы выйти из i3 не завершая работу X-сервера можно использовать **$mod+Shift+e**. По умолчанию появится диалоговое окно, которое попросит подтвердить операцию.

### 2.11. Плавающий режим

Плавающий (floating) режим является обратным тайловому. Положение и размеры окна регулируются пользователем вручную, а не автоматическим режимом i3. Использование этого режима нарушает парадигму тайлинга, но может быть полезно для некоторых случаев, когда появляются диалоговые окна (например, "Сохранить как") или окна панели инструментов (GIMP или подобные). Такие окна обычно оставляют подсказку для оконных менеджеров и открываются в плавающем режиме по умолчанию.

Переключить плавающий режим для окна можно с помощью сочетаний **$mod+Shift+Space**. Перетаскивая заголовок окна с помощью мыши можно перемещать окно по рабочему пространству. Чтобы изменить размер нужно зажать и тянуть рамку окна. Также это можно делать с помощью floating_modifier (модификатора плавающих окон) [TODO: добавить ссылку на главу]. Еще один способ это зажать и тянуть ПКМ в заголовке окна.

Об изменении размера плавающих окон с клавиатуры см. режим привязки изменения размера, предусмотренный [конфигурацией i3 по умолчанию](https://github.com/i3/i3/blob/next/etc/config.keycodes).

Плавающие окна всегда находятся поверх тайлинговых.

## 3. Дерево

i3 собирает всю информацию из вывода X11. Рабочие пространства и расположение окон находятся внутри некоего дерева. Корневым узлом является корневое окно X11, за ним следуют выводы X11, затем области стыковки и контейнер содержимого, рабочие области и, наконец, сами окна. 

В предыдущих версиях i3 мы имели несколько списков (выводов, рабочих пространств) и таблицу для каждой рабочей области. Этот подход оказался сложным для использования, понимания и реализации.

### 3.1. Дерево состоит из контейнеров

Кирпичики нашего дерева это контейнеры. Контейнер может содержать окно. Имеется в виду окно X11, которое можно видеть и использовать (например, браузер). Помимо этого, контейнер может содержать другие контейнеры. Простой пример – рабочее пространство: когда i3 запущен с одним монитором, одним рабочим пространством и открыто два терминальных окна, дерево будет выглядеть так:

![Дерево окон](https://i3wm.org/docs/tree-layout2.png)

![Два терминальных окна в одном контейнере](https://i3wm.org/docs/tree-shot4.png)

### 3.2. Ориентация и сплит-контейнеры

При использовании дерева в качестве структуры данных вполне естественно использовать так называемые *сплит-контейнеры* (разделенные контейнеры) для построения раскладки. В i3 каждый *контейнер* имеет свою ориентацию (горизонтальная, вертикальная или неопределенная) и зависит она от раскладки этого контейнера (вертикальная для *splitv* и *stacking*, горизонтальная для *splith* и *tabbed*). В нашем примере с рабочим пространством раскладкой по умолчанию для контейнера является *splith* (большинство мониторов в настоящее время широкоэкранные). Если изменить раскладку на *splitv* (**$mod+v** по умолчанию) и открыть два терминала, то i3 расположит их таким образом:

![Вертикальная ориентация](https://i3wm.org/docs/tree-shot2.png)

С версии 4 i3 имеет интересную возможность – разделять все что угодно: представим, что у нас есть два терминала в рабочем пространстве (в раскладке *splith*, что является горизонтальной ориентацией), фокус окна стоит на правом терминале. Теперь давайте откроем еще один терминал ниже существующего. Если бы мы просто открыли новое окно терминала, то оно отобразилось бы справа благодаря splith-раскладке. Вместо этого нажмите **$mod+v**, чтобы разделить контейнер следуя splitv-раскладке (чтобы открыть горизонтальный сплит-контейнер используйте **$mod+h**). Теперь можно открыть терминал и он появится ниже существующего:

![Вертикальный сплит-контейнер](https://i3wm.org/docs/tree-shot1.png)

![Дерево окон](https://i3wm.org/docs/tree-layout1.png)

Вы, наверное, уже догадались, что нет ограничения в том, насколько глубокой может быть иерархия сплитов (разделений).

### 3.3. Фокусировка на родителе

Давайте оставим вышеуказанный пример. У нас есть терминал слева и два вертикально разделенных терминала справа, фокус на нижнем правом. При открытии нового окна оно откроется ниже текущего.

Как открыть терминальное окно справа от существующего? Для этого нужно переместить фокус на родительский контейнер. В конфигурации по умолчанию для этого используется **$mod+a**, чтобы переместиться на один контейнер выше по дереву (эту операцию можно повторить несколько раз, пока Вы не попадете на контейнер рабочего пространства). В нашем случае вы сфокусируетесь на *вертикальном контейнере*, который находится внутри горизонтально ориентированной рабочей области. Теперь новые окна будут открываться справа от *вертикального сплит-контейнера*:

![shot3](https://i3wm.org/docs/tree-shot3.png)

### 3.4. Неявные контейнеры

В некоторых случаях i3 необходимо неявно создать контейнер для выполнения команды пользователя.

Например: вы запускаете i3 с одним монитором и одной рабочей областью, на которой открываете 3 терминальных окна. Все эти окна напрямую прикрепляются к одному узлу внутри дерева раскладки i3 – узлу рабочей области. По умолчанию узел рабочей области ориентирован *горизонтально*.

Теперь вы перемещаете один из этих терминалов вниз (**$mod+Shift+k** по умолчанию). Ориентация узла рабочей области изменится на *вертикальную*. Окно терминала, которое вы переместили вниз, прикреплено непосредственно к рабочей области и появляется в нижней части экрана. Для размещения двух других окон терминала был создан новый (горизонтальный) контейнер. Вы заметите это при переходе в режим вкладок (например). В результате у вас появится одна вкладка с изображением разделенного контейнера (например, "H[urxvt firefox]"), а другая - терминальное окно, которое вы переместили вниз.